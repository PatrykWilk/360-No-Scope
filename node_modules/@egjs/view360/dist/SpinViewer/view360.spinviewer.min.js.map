{"version":3,"file":"view360.spinviewer.min.js","sources":["../../src/utils/browser.js","../../src/utils/browserFeature.js","../../src/version.js","../../src/SpinViewer/SpriteImage.js","../../src/SpinViewer/SpinViewer.js"],"sourcesContent":["/**\n * Copyright (c) 2015 NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\n/* eslint-disable no-new-func, no-nested-ternary */\nconst win = typeof window !== \"undefined\" && window.Math === Math ? window : typeof self !== \"undefined\" && self.Math === Math ? self : Function(\"return this\")();\n/* eslint-enable no-new-func, no-nested-ternary */\n\nconst doc = win.document;\n\nexport {\n\twin as window,\n\tdoc as document\n};\n","/**\n * Copyright (c) 2015 NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport {window as win, document as doc} from \"./browser\";\n\nwin.Float32Array = (typeof win.Float32Array !== \"undefined\") ? win.Float32Array : win.Array;\n\nconst Float32Array = win.Float32Array;\nconst getComputedStyle = win.getComputedStyle;\nconst userAgent = win.navigator.userAgent;\nconst SUPPORT_TOUCH = \"ontouchstart\" in win;\nconst SUPPORT_DEVICEMOTION = \"ondevicemotion\" in win;\nconst DeviceMotionEvent = win.DeviceMotionEvent;\nconst devicePixelRatio = win.devicePixelRatio;\n\nconst TRANSFORM = (function() {\n\tconst docStyle = doc.documentElement.style;\n\tconst target = [\"transform\", \"webkitTransform\", \"msTransform\", \"mozTransform\"];\n\n\tfor (let i = 0, len = target.length; i < len; i++) {\n\t\tif (target[i] in docStyle) {\n\t\t\treturn target[i];\n\t\t}\n\t}\n\treturn \"\";\n})();\n\n// check for will-change support\nconst SUPPORT_WILLCHANGE = win.CSS && win.CSS.supports &&\n\twin.CSS.supports(\"will-change\", \"transform\");\n\nexport {\n\tFloat32Array,\n\tgetComputedStyle,\n\tuserAgent,\n\tTRANSFORM,\n\tSUPPORT_TOUCH,\n\tSUPPORT_DEVICEMOTION,\n\tSUPPORT_WILLCHANGE,\n\tDeviceMotionEvent,\n\tdevicePixelRatio\n};\n\n","const VERSION = \"#__VERSION__#\";\n\nexport {\n\tVERSION\n};\n","import Component from \"@egjs/component\";\nimport {TRANSFORM, SUPPORT_WILLCHANGE} from \"../utils/browserFeature\";\nimport {VERSION} from \"../version\";\n/**\n * @class eg.view360.SpriteImage\n * @classdesc A module that displays a single or continuous image of any one of the \"sprite images\". SpinViewer internally uses SpriteImage to show each frame of the sprite image.\n * @ko 스프라이트 이미지 중 임의의 한 프레임을 단발성 혹은 연속적으로 보여주는 컴포넌트입니다. SpinViewer 는 내부적으로 SpriteImage 를 사용하여 스프라이트 이미지의 각 프레임을 보여줍니다.\n * @extends eg.Component\n *\n * @param {HTMLElement} element The element to show the image <ko>이미지를 보여줄 대상 요소</ko>\n * @param {Object} options The option object<ko>파라미터 객체</ko>\n * @param {String} options.imageUrl The url of the sprite image <ko>스프라이트 이미지의 url</ko>\n * @param {Number} [options.rowCount=1] Number of horizontal frames in the sprite image <ko>스프라이트 이미지의 가로 프레임 갯수</ko>\n * @param {Number} [options.colCount=1] Number of vertical frames in the sprite image <ko>스프라이트 이미지의 세로 프레임 갯수</ko>\n * @param {Number|String} [options.width=\"auto\"] The width of the target element to show the image <ko>이미지를 보여줄 대상 요소의 너비</ko>\n * @param {Number|String} [options.height=\"auto\"] The height of the target element to show the image <ko>이미지를 보여줄 대상 요소의 높이</ko>\n * @param {Boolean} [options.autoHeight=true] Whether to automatically set the height of the image area to match the original image's proportion <ko>원본 이미지 비율에 맞게 이미지 영역의 높이를 자동으로 설정할지 여부</ko>\n * @param {Number[]} [options.colRow=[0, 0]] The column, row coordinates of the first frame of the sprite image (based on 0 index) <ko> 스프라이트 이미지 중 처음 보여줄 프레임의 (column, row) 좌표 (0 index 기반)</ko>\n * @param {Number} [options.frameIndex=0] frameIndex specifies the index of the frame to be displayed in the \"Sprite image\". The frameIndex order is zero-based and indexed in Z form (left-to-right, top-to-bottom, and newline again from left to right).<br>- colRow is equivalent to frameIndex. However, if colRow is specified at the same time, colRow takes precedence.<ko>스프라이트 이미지 중에서 보여질 프레임의 인덱스를 지정합니다. frameIndex 순서는 0부터 시작하며 Z 형태(왼쪽에서 오른쪽, 위에서 아래, 개행 시 다시 왼쪽 부터)로 인덱싱합니다.<br>- colRow 는 frameIndex 와 동일한 기능을 합니다. 단, colRow 가 동시에 지정된 경우 colRow 가 우선합니다.</ko>\n * @param {Number} [options.scale=1] Spin scale (The larger the spin, the more).<ko>Spin 배율 (클 수록 더 많이 움직임)</ko>\n *\n * @support {\"ie\": \"9+\", \"ch\" : \"latest\", \"ff\" : \"latest\",  \"sf\" : \"latest\", \"edge\" : \"latest\", \"ios\" : \"7+\", \"an\" : \"2.3+ (except 3.x)\"}\n * @example\n *\n * // Initialize SpriteImage\n *\n * var el = document.getElementById(\"image-div\");\n * var sprites = new eg.view360.SpriteImage(el, {\n * \timageUrl: \"/img/bag360.jpg\", // required\n * \trowCount: 24\n * });\n */\nexport default class SpriteImage extends Component {\n\tstatic VERSION = VERSION;\n\tconstructor(element, options) {\n\t\tsuper();\n\t\tconst opt = options || {};\n\n\t\tthis._el = element;\n\t\tthis._rowCount = opt.rowCount || 1;\n\t\tthis._colCount = opt.colCount || 1;\n\t\tthis._totalCount = this._rowCount * this._colCount;// total frames\n\t\tthis._width = opt.width || \"auto\";\n\t\tthis._height = opt.height || \"auto\";\n\t\tthis._autoHeight = opt.autoHeight != null ? opt.autoHeight : \"true\"; // If autoHeight is specified, _height will be overwritten.\n\t\tthis._colRow = [0, 0];\n\n\t\tif (opt.colRow) {\n\t\t\tthis._colRow = opt.colRow;\n\t\t} else if (opt.frameIndex) {\n\t\t\tthis.setFrameIndex(opt.frameIndex);\n\t\t}\n\n\t\tthis._el.style.width = SpriteImage._getSizeString(this._width);\n\t\tthis._el.style.height = SpriteImage._getSizeString(this._height);\n\n\t\tif (!opt.imageUrl) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.trigger(\"imageError\", {\n\t\t\t\t\timageUrl: opt.imageUrl\n\t\t\t\t});\n\t\t\t}, 0);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._image = new Image();\n\t\t/**\n\t\t * Event\n\t\t */\n\t\tthis._image.onload = () => {\n\t\t\tthis._bg = SpriteImage._createBgDiv(\n\t\t\t\tthis._image, this._rowCount, this._colCount, this._autoHeight);\n\t\t\tthis._el.appendChild(this._bg);\n\t\t\tthis.setColRow(this._colRow[0], this._colRow[1]);\n\n\t\t\t/**\n\t\t\t * Events that occur when component loading is complete\n\t\t\t * @ko 컴포넌트 로딩이 완료되면 발생하는 이벤트\n\t\t\t * @name eg.view360.SpriteImage#load\n\t\t\t * @event\n\t\t\t * @param {Object} param The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n\t\t\t * @param {HTMLElement} param.target The target element for which to display the image <ko>이미지를 보여줄 대상 엘리먼트</ko>\n\t\t\t * @param {HTMLElement} param.bgElement Generated background image element <ko>생성된 background 이미지 엘리먼트</ko>\n\t\t\t *\n\t\t\t * @example\n\t\t\t *\n\t\t\t * sprites.on({\n\t\t\t *\t\"load\" : function(evt) {\n\t\t\t *\t\tconsole.log(\"load event fired - e.target\", e.target, \"e.bgElement\", e.bgElement);\n\t\t\t *\t}\n\t\t\t * });\n\t\t\t */\n\t\t\tthis.trigger(\"load\", {\n\t\t\t\ttarget: this._el,\n\t\t\t\tbgElement: this._bg\n\t\t\t});\n\n\t\t\tif (this._autoPlayReservedInfo) {\n\t\t\t\tthis.play(this._autoPlayReservedInfo);\n\t\t\t\tthis._autoPlayReservedInfo = null;\n\t\t\t}\n\t\t};\n\n\t\tthis._image.onerror = e => {\n\t\t\t/**\n\t\t\t * An event that occurs when the image index is changed by the user's left / right panning\n\t\t\t * @ko 사용자의 좌우 Panning 에 의해 이미지 인덱스가 변경되었을때 발생하는 이벤트\n\t\t\t * @name eg.view360.SpriteImage#imageError\n\t\t\t * @event\n\t\t\t * @param {Object} param The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n\t\t\t * @param {String} param.imageUrl User-specified image URL <ko>사용자가 지정한 이미지 URL</ko>\n\t\t\t *\n\t\t\t * @example\n\t\t\t *\n\t\t\t * sprites.on({\n\t\t\t *\t\"imageError\" : function(evt) {\n\t\t\t *\t\t// Error handling\n\t\t\t *\t\tconsole.log(e.imageUrl);\n\t\t\t *\t}\n\t\t\t * });\n\t\t\t */\n\t\t\tthis.trigger(\"imageError\", {\n\t\t\t\timageUrl: opt.imageUrl\n\t\t\t});\n\t\t};\n\n\t\tthis._image.src = opt.imageUrl;\n\t}\n\n\tstatic _createBgDiv(img, rowCount, colCount, autoHeight) {\n\t\tconst el = document.createElement(\"div\");\n\n\t\tel.style.position = \"relative\";\n\t\tel.style.overflow = \"hidden\";\n\n\t\timg.style.position = \"absolute\";\n\t\timg.style.width = `${colCount * 100}%`;\n\t\timg.style.height = `${rowCount * 100}%`;\n\t\t/** Prevent image from being dragged on IE10, IE11, Safari especially */\n\t\timg.ondragstart = () => (false); // img.style.pointerEvents = \"none\";\n\t\t// Use hardware accelerator if available\n\t\tSUPPORT_WILLCHANGE && (img.style.willChange = \"transform\");\n\n\t\tel.appendChild(img);\n\n\t\tconst unitWidth = img.width / colCount;\n\t\tconst unitHeight = img.height / rowCount;\n\n\t\tif (autoHeight) {\n\t\t\tconst r = unitHeight / unitWidth;\n\n\t\t\tel.style.paddingBottom = `${r * 100}%`;\n\t\t} else {\n\t\t\tel.style.height = \"100%\";\n\t\t}\n\n\t\treturn el;\n\t}\n\n\t/**\n\t * Specifies the frameIndex of the frame to be shown in the sprite image.\n\t * @ko 스프라이트 이미지 중 보여질 프레임의 frameIndex 값을 지정\n\t * @method eg.view360.SpriteImage#setFrameIndex\n\t * @param {Number} frameIndex frame index of a frame<ko>프레임의 인덱스</ko>\n\t *\n\t * @example\n\t *\n\t * sprites.setFrameIndex(0, 1);// col = 0, row = 1\n\t */\n\tsetFrameIndex(index) {\n\t\tconst colRow = this.toColRow(index);\n\n\t\tthis.setColRow(colRow[0], colRow[1]);\n\t}\n\n\t/**\n\t * Returns the frameIndex of the frame to be shown in the sprite image.\n\t * @ko 스프라이트 이미지 중 보여지는 프레임의 index 값을 반환\n\t * @method eg.view360.SpriteImage#getFrameIndex\n\t * @return {Number} frame index <ko>frame 인덱스</ko>\n\t *\n\t * @example\n\t *\n\t * var frameIndex = sprites.getFrameIndex(); // eg. frameIndex = 1\n\t *\n\t */\n\tgetFrameIndex() {\n\t\treturn this._colRow[1] * this._colCount + this._colRow[0];\n\t}\n\n\t/**\n\t * Specifies the col and row values of the frame to be shown in the sprite image.\n\t * @ko 스프라이트 이미지 중 보여질 프레임의 col, row 값을 지정\n\t * @method eg.view360.SpriteImage#setColRow\n\t * @param {Number} col Column number of a frame<ko>프레임의 행값</ko>\n\t * @param {Number} row Row number of a frame<ko>프레임의 열값</ko>\n\t *\n\t * @example\n\t *\n\t * sprites.setlColRow(1, 2); // col = 1, row = 2\n\t */\n\tsetColRow(col, row) {\n\t\tif (row > this._rowCount - 1 || col > this._colCount - 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._image && TRANSFORM) {\n\t\t\t// NOTE: Currently, do not apply translate3D for using layer hack. Do we need layer hack for old browser?\n\t\t\tthis._image.style[TRANSFORM] = `translate(${-(col / this._colCount * 100)}%, ${-(row / this._rowCount * 100)}%)`;\n\t\t}\n\n\t\tthis._colRow = [col, row];\n\t}\n\n\t/**\n\t * Returns the col and row values of the frame to be shown in the sprite image.\n\t * @ko 스프라이트 이미지 중 보여지는 프레임의 col, row 값을환반환\n\t * @method eg.view360.SpriteImage#gelColRow\n\t * @return {Number[]} Array containing col, row<ko>col, row 정보를 담는 배열</ko>\n\t *\n\t * @example\n\t *\n\t * var colRow = sprites.getlColRow();\n\t * // colRow = [1, 2] - index of col is 1, index of row is 2\n\t *\n\t */\n\tgetColRow() {\n\t\treturn this._colRow;\n\t}\n\n\tstatic _getSizeString(size) {\n\t\tif (typeof size === \"number\") {\n\t\t\treturn `${size}px`;\n\t\t}\n\n\t\treturn size;\n\t}\n\n\t/**\n\t * Stop playing\n\t * @ko play 되고 있던 프레임 재생을 중지합니다.\n\t * @method eg.view360.SpriteImage#stop\n\t *\n\t * @example\n\t *\n\t * viewer.stop();\n\t *\n\t */\n\tstop() {\n\t\tif (this._autoPlayTimer) {\n\t\t\tclearInterval(this._autoPlayTimer);\n\t\t\tthis._autoPlayTimer = null;\n\t\t}\n\t}\n\n\t/**\n\t * Switches frames sequentially in the 'interval' starting from the currently displayed frame and plays all frames by 'playCount'.\n\t * @ko 현재 보여지고 있는 프레임을 시작으로 'interval' 간격으로 순차적으로 프레임을 전환하며 모든 프레임을 'playCount' 만큼 재생한다.\n\t * @method eg.view360.SpriteImage#play\n\t * @param {Object} param The parameter object<ko>파라미터 객체</ko>\n\t * @param {Number} [param.interval=1000 / totalFrameCount] Interframe Interval - in milliseconds<ko>프레임간 간격 - 밀리세컨드 단위</ko>\n\t * @param {Number} [param.playCount=0] PlayCount = 1 in which all frames are reproduced once, and playCount = n in which all frames are repeated n times. playCount = 0 in which all frames are repeated infinitely<ko>모든 프레임을 1회씩 재생한 것이 playCount = 1, 모든 프레임을 n 회 재상한 것이 playCount = n 이 된다. 0 dms 무한반복</ko>\n\t *\n\t * @example\n\t *\n\t * viewer.play({angle: 16, playCount: 1});\n\t *\n\t */\n\tplay({interval, playCount} = {interval: 1000 / this._totalCount, playCount: 0}) {\n\t\tif (!this._bg) {\n\t\t\tthis._autoPlayReservedInfo = {interval, playCount};\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._autoPlayTimer) {\n\t\t\tclearInterval(this._autoPlayTimer);\n\t\t\tthis._autoPlayTimer = null;\n\t\t}\n\n\t\tlet frameIndex = this.getFrameIndex();\n\t\tlet count = 0;\n\t\tlet frameCount = 0; // for checking 1 cycle\n\n\t\tthis._autoPlayTimer = setInterval(() => {\n\t\t\tframeIndex %= this._totalCount;\n\t\t\tconst colRow = this.toColRow(frameIndex);\n\n\t\t\tthis.setColRow(colRow[0], colRow[1]);\n\t\t\tframeIndex++;\n\n\t\t\t// Done 1 Cycle?\n\t\t\tif (++frameCount === this._totalCount) {\n\t\t\t\tframeCount = 0;\n\t\t\t\tcount++;\n\t\t\t}\n\n\t\t\tif (playCount > 0 && count === playCount) {\n\t\t\t\tclearInterval(this._autoPlayTimer);\n\t\t\t}\n\t\t}, interval);\n\t}\n\n\ttoColRow(frameIndex) {\n\t\tconst colCount = this._colCount;\n\t\tconst rowCount = this._rowCount;\n\n\t\tif (frameIndex < 0) {\n\t\t\treturn [0, 0];\n\t\t} else if (frameIndex >= this._totalCount) {\n\t\t\treturn [colCount - 1, rowCount - 1];\n\t\t}\n\n\t\tconst col = frameIndex % colCount;\n\t\tconst row = Math.floor(frameIndex / colCount);\n\n\t\t// console.log(frameIndex, col, row);\n\t\treturn [col, row];\n\t}\n}\n","import Component from \"@egjs/component\";\nimport Axes, {PanInput} from \"@egjs/axes\";\nimport SpriteImage from \"./SpriteImage\";\nimport {VERSION} from \"../version\";\n\nconst DEFAULT_PAN_SCALE = 0.21;\n\n/**\n * @class eg.view360.SpinViewer\n * @classdesc A module used to displays each image sequentially according to the direction of the user's touch movement (left / right) of the sprite image that is collected by rotating the object.\n * @ko 물체 주위를 회전하여 촬영한 이미지들을 모은 스프라이트 이미지를 사용자의 터치 이동 방향(좌 / 우) 에 따라 각 이미지들을 순차적으로 보여주는 컴포넌트입니다.\n * @extends eg.Component\n *\n * @param {HTMLElement} element The element to show the image <ko>이미지를 보여줄 대상 요소</ko>\n * @param {Object} options The option object<ko>파라미터 객체</ko>\n * @param {String} options.imageUrl The url of the sprite image <ko>스프라이트 이미지의 url</ko>\n * @param {Number} [options.rowCount=1] Number of horizontal frames in the sprite image <ko>스프라이트 이미지의 가로 프레임 갯수</ko>\n * @param {Number} [options.colCount=1] Number of vertical frames in the sprite image <ko>스프라이트 이미지의 세로 프레임 갯수</ko>\n * @param {Number|String} [options.width=\"auto\"] The width of the target element to show the image <ko>이미지를 보여줄 대상 요소의 너비</ko>\n * @param {Number|String} [options.height=\"auto\"] The height of the target element to show the image <ko>이미지를 보여줄 대상 요소의 높이</ko>\n * @param {Boolean} [options.autoHeight=true] Whether to automatically set the height of the image area to match the original image's proportion <ko>원본 이미지 비율에 맞게 이미지 영역의 높이를 자동으로 설정할지 여부</ko>\n * @param {Number[]} [options.colRow=[0, 0]] The column, row coordinates of the first frame of the sprite image (based on 0 index) <ko> 스프라이트 이미지 중 처음 보여줄 프레임의 (column, row) 좌표 (0 index 기반)</ko>\n * @param {Number} [options.scale=1] Spin scale (The larger the spin, the more).<ko>Spin 배율 (클 수록 더 많이 움직임)</ko>\n * @support {\"ie\": \"9+\", \"ch\" : \"latest\", \"ff\" : \"latest\",  \"sf\" : \"latest\", \"edge\" : \"latest\", \"ios\" : \"7+\", \"an\" : \"2.3+ (except 3.x)\"}\n * @example\n *\n * // Initialize SpinViewer\n * var el = document.getElementById(\"product-360\");\n * var viewer = new eg.view360.SpinViewer(el, {\n * \timageUrl: \"/img/bag360.jpg\", // required\n * \trowCount: 24 //required\n * });\n */\nexport default class SpinViewer extends Component {\n\t/**\n\t * Version info string\n\t * @ko 버전정보 문자열\n\t * @name VERSION\n\t * @static\n\t * @type {String}\n\t * @example\n\t * eg.view360.SpinViewer.VERSION;  // ex) 3.0.1\n\t * @memberof eg.view360.SpinViewer\n\t */\n\tstatic VERSION = VERSION;\n\tconstructor(element, options) {\n\t\tsuper();\n\n\t\tthis._el = element;\n\n\t\tconst opt = Object.assign({}, options);\n\t\tconst colCount = opt.colCount || 1;\n\t\tconst rowCount = opt.rowCount || 1;\n\n\t\tthis._scale = (opt.scale || 1);\n\t\tthis._panScale = this._scale * DEFAULT_PAN_SCALE;\n\n\t\tthis._frameCount = colCount * rowCount;\n\n\t\t// Init SpriteImage\n\t\tthis._sprites = new SpriteImage(element, opt).on({\n\t\t\t\"load\": evt => {\n\t\t\t\t/**\n\t\t\t\t * Events that occur when component loading is complete\n\t\t\t\t * @ko 컴포넌트 로딩이 완료되면 발생하는 이벤트\n\t\t\t\t * @name eg.view360.SpinViewer#load\n\t\t\t\t * @event\n\t\t\t\t * @param {Object} param The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n\t\t\t\t * @param {HTMLElement} param.target The target element for which to display the image <ko>이미지를 보여줄 대상 엘리먼트</ko>\n\t\t\t\t * @param {HTMLElement} param.bgElement Generated background image element <ko>생성된 background 이미지 엘리먼트</ko>\n\t\t\t\t *\n\t\t\t\t * @example\n\t\t\t\t *\n\t\t\t\t * viwer.on({\n\t\t\t\t *\t\"load\" : function(evt) {\n\t\t\t\t *\t\tthis.spinBy(360, {duration: 300});\n\t\t\t\t *\t}\n\t\t\t\t * });\n\t\t\t\t */\n\t\t\t\tthis.trigger(\"load\", evt);\n\t\t\t},\n\t\t\t\"imageError\": evt => {\n\t\t\t\t/**\n\t\t\t\t * An event that occurs when the image index is changed by the user's left / right panning\n\t\t\t\t * @ko 사용자의 좌우 Panning 에 의해 이미지 인덱스가 변경되었을때 발생하는 이벤트\n\t\t\t\t * @name eg.view360.SpinViewer#imageError\n\t\t\t\t * @event\n\t\t\t\t * @param {Object} param The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n\t\t\t\t * @param {String} param.imageUrl User-specified image URL <ko>사용자가 지정한 이미지 URL</ko>\n\t\t\t\t *\n\t\t\t\t * @example\n\t\t\t\t *\n\t\t\t\t * viewer.on({\n\t\t\t\t *\t\"imageError\" : function(evt) {\n\t\t\t\t *\t\t// Error handling\n\t\t\t\t *\t\tconsole.log(e.imageUrl);\n\t\t\t\t *\t}\n\t\t\t\t * });\n\t\t\t\t */\n\t\t\t\tthis.trigger(\"imageError\", {\n\t\t\t\t\timageUrl: evt.imageUrl\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// Init Axes\n\t\tthis._panInput = new PanInput(this._el, {\n\t\t\tscale: [this._panScale, this._panScale]\n\t\t});\n\t\tthis._axes = new Axes({\n\t\t\tangle: {\n\t\t\t\trange: [0, 359],\n\t\t\t\tcircular: true\n\t\t\t}\n\t\t}).on({\n\t\t\t\"change\": evt => {\n\t\t\t\tconst curr = Math.floor(evt.pos.angle / (360 / this._frameCount));\n\t\t\t\tconst frameIndex = this._frameCount - curr - 1;\n\n\t\t\t\tthis._sprites.setFrameIndex(frameIndex);\n\n\t\t\t\t/**\n\t\t\t\t * An event that occurs when the image index is changed by the user's left / right panning\n\t\t\t\t * @ko 사용자의 좌우 Panning 에 의해 이미지 인덱스가 변경되었을때 발생하는 이벤트\n\t\t\t\t * @name eg.view360.SpinViewer#change\n\t\t\t\t * @event\n\t\t\t\t * @param {Object} param The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n\t\t\t\t * @param {Number[]} param.colRow Column, row of the frame in the sprite image <ko>스프라이트 이미지 내 프레임의 column, row</ko>\n\t\t\t\t * @param {Number} param.frameIndex Index value that is sequentially appended in Z direction based on col and row.<ko>col, row 를 기반으로 Z 방향으로 순차적으로 붙여지는 index 값</ko>\n\t\t\t\t * @param {Number} param.angle The angle that is currently internally held at an angle between 0 and 359. (not a real product angle) <ko>0 ~ 359 범위의 각도로 현재 내부적으로 유지하고 있는 각도 (실제 이미지의 각도가 아님)</ko>\n\t\t\t\t *\n\t\t\t\t * @example\n\t\t\t\t *\n\t\t\t\t * viwer.on({\n\t\t\t\t *\t\"change\" : function(evt) {\n\t\t\t\t *\t\tconsole.log(event.frameIndex, event.colRow, event.angle);   // event.colRow = [0, 4] event.frameIndex = 4, event = 30\n\t\t\t\t *\t}\n\t\t\t\t * });\n\t\t\t\t */\n\t\t\t\tthis.trigger(\"change\", {\n\t\t\t\t\tframeIndex,\n\t\t\t\t\tcolRow: this._sprites.getColRow(),\n\t\t\t\t\tangle: evt.pos.angle\n\t\t\t\t});\n\t\t\t},\n\t\t\t\"animationEnd\": evt => {\n\t\t\t\t/**\n\t\t\t\t * This event is fired when animation ends.\n\t\t\t\t * @ko 에니메이션이 끝났을 때 발생하는 이벤트\n\t\t\t\t * @name eg.view360.SpinViewer#animationEnd\n\t\t\t\t * @event\n\t\t\t\t * @param {Object} param The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n\t\t\t\t * @param {Boolean} param.isTrusted true if an event was generated by the user action, or false if it was caused by a script or API call<ko>사용자의 액션에 의해 이벤트가 발생하였으면 true, 스크립트나 API호출에 의해 발생하였을 경우에는 false를 반환한다.</ko>\n\t\t\t\t *\n\t\t\t\t * @example\n\t\t\t\t *\n\t\t\t\t * viwer.on({\n\t\t\t\t *\t\"animationEnd\" : function(evt) {\n\t\t\t\t *\t\t// evt.isTrusted === true or false\n\t\t\t\t *\t}\n\t\t\t\t * });\n\t\t\t\t */\n\t\t\t\tthis.trigger(\"animationEnd\", {\n\t\t\t\t\tisTrusted: evt.isTrusted\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis._axes.connect(\"angle\", this._panInput);\n\t}\n\n\t/**\n\t * Set spin scale\n\t * @ko scale 을 조정할 수 있는 함수\n\t * @method eg.view360.SpinViewer#setScale\n\t * @param {Number} scale Rotation multiples at spin, the larger the rotation<ko>Spin 시 회전 배수값, 커질 수록 더 많이 회전</ko>\n\t *\n\t * @return {Object} Instance of SpinViewer <ko>SpinViewer 인스턴스</ko>\n\t *\n\t * @example\n\t *\n\t * viewer.setScale(2);// It moves twice as much.\n\t */\n\tsetScale(scale) {\n\t\tif (isNaN(scale) || scale < 0) {\n\t\t\treturn this;\n\t\t}\n\n\t\tthis._scale = scale;\n\t\tthis._panScale = scale * DEFAULT_PAN_SCALE;\n\t\tthis._panInput.options.scale = [this._panScale, this._panScale];\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Get spin scale\n\t * @ko scale 값을 반환한다.\n\t * @method eg.view360.SpinViewer#getScale\n\t *\n\t * @return {Number} Rotation multiples at spin, the larger the rotation<ko>Spin 시 회전 배수값, 커질 수록 더 많이 회전</ko>\n\t *\n\t * @example\n\t *\n\t * viewer.getScale();// It returns number\n\t */\n\tgetScale() {\n\t\treturn this._scale;\n\t}\n\n\t/**\n\t * It gives the effect of rotating for a certain duration by the specified angle based on the current rotation angle.\n\t * @ko 현재 회전 각도를 기준으로 지정된 각도(angle)만큼 일정 시간동안(duration) 회전하는 효과를 준다.\n\t * @method eg.view360.SpinViewer#spinBy\n\t *\n\t * @param {Number} [angle = 0] angle<ko>상대적 회전 각도</ko>\n\t * @param {Object} param The parameter object<ko>파라미터 객체</ko>\n\t * @param {Number} [param.duration = 0] duration<ko>회전할 시간 - 밀리세컨드 단위</ko>\n\t *\n\t * @return {Object} Instance of SpinViewer <ko>SpinViewer 인스턴스</ko>\n\t *\n\t * @example\n\t *\n\t * viewer.spinBy(720, {duration: 500});\n\t */\n\tspinBy(angle = 0, param = {duration: 0}) {\n\t\tthis._axes.setBy({angle}, param.duration);\n\t\treturn this;\n\t}\n\n\t/**\n\t * It gives the effect of rotating for a certain duration (duration) by the specified angle (angle).\n\t * @ko 지정된 각도(angle)만큼 일정 시간동안(duration) 회전하는 효과를 준다.\n\t * @method eg.view360.SpinViewer#spinTo\n\t *\n\t * @param {Number} [angle = 0] angle<ko>회전 각도</ko>\n\t * @param {Object} param The parameter object<ko>파라미터 객체</ko>\n\t * @param {Number} [param.duration = 0] duration<ko>회전할 시간 - 밀리세컨드 단위</ko>\n\t *\n\t * @return {Object} Instance of SpinViewer <ko>SpinViewer 인스턴스</ko>\n\t *\n\t * @example\n\t *\n\t * viewer.spinTo(30, {duration:100});\n\t */\n\tspinTo(angle = 0, param = {duration: 0}) {\n\t\tthis._axes.setTo({angle}, param.duration);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns current angles\n\t * @ko 현재 각도를 반환한다.\n\t *\n\t * @return {Number} Current angle <ko>현재 각도</ko>\n\t */\n\tgetAngle() {\n\t\treturn this._axes.get().angle || 0;\n\t}\n}\n"],"names":["win","window","Math","self","Function","doc","document","Float32Array","Array","getComputedStyle","navigator","userAgent","DeviceMotionEvent","devicePixelRatio","TRANSFORM","docStyle","documentElement","style","target","i","len","length","SUPPORT_WILLCHANGE","CSS","supports","VERSION","SpriteImage","element","options","opt","_el","_rowCount","rowCount","_colCount","colCount","_totalCount","_this","_width","width","_height","height","_autoHeight","autoHeight","_colRow","colRow","frameIndex","setFrameIndex","_getSizeString","imageUrl","_image","Image","onload","_bg","_createBgDiv","appendChild","setColRow","trigger","bgElement","_autoPlayReservedInfo","play","onerror","e","src","setTimeout","img","el","createElement","position","overflow","ondragstart","willChange","unitWidth","unitHeight","r","paddingBottom","index","this","toColRow","getFrameIndex","col","row","getColRow","size","stop","_autoPlayTimer","clearInterval","interval","playCount","count","frameCount","setInterval","_this2","floor","Component","SpinViewer","_extends","_scale","scale","_panScale","_frameCount","_sprites","on","evt","_panInput","PanInput","_axes","Axes","angle","range","circular","curr","pos","isTrusted","connect","setScale","isNaN","getScale","spinBy","param","duration","setBy","spinTo","setTo","getAngle","get"],"mappings":"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"}